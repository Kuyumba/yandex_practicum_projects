# Проект № 9
# Коэффициент восстановления золота из руды.

Необходимо подготовить прототип модели машинного обучения.
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды.

В нашем распоряжении данные с параметрами добычи и очистки золота.

## Технологический процесс.

1. Добытая порода проходит стадию первичной обработки - дробление, измельчение

2. Дробленая мелкодисперсная порода смешивается с водой, образуя пульпу.

3. Пульпа отправляется на флотацию. При флотации тонкодисперсное сырье в смеси с водой и специальными веществами, подвергается интенсивному вспениванию. В результате металлические элементы прикрепляются к пузырькам воздуха и всплывают, отходы оседают на дно.

4. После флотации получается черновой концентрат и "отвальные хвосты", то есть остатки породы с низкой концентрацией полезных металлов.

5. Черновой концентрат проходит две стадии очистки. На выходе получается финальный концентрат и новые отвальные хвосты.


## Описание данных 

- gold_recovery_train.csv - обучающая выборка
- gold_recovery_test.csv - тестовая выборка
- gold_recovery_full.csv - исходные данные (содержат обучающую и тестовую выборки со всеми признаками)

Данные индексируются датой и временем получения информации. Соседние по времени параметры часто похожи.
Некоторые параметры недоступны, потому что замеряются или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей.


### Наименование признаков

Наименование признаков выглядит следующим образом:
[этап].[тип_параметра].[название_параметра]

Пример:
rougher.input.feed_ag

#### Возможные значения для блока [этап]:

- rougher — флотация
- primary_cleaner — первичная очистка
- secondary_cleaner — вторичная очистка
- final — финальные характеристики

#### Возможные значения для блока [тип_параметра]:

- input — параметры сырья
- output — параметры продукта
- state — параметры, характеризующие текущее состояние этапа
- calculation — расчётные характеристики

#### Возможные значения для блока [название параметра]:
- concentrate_ag
- concentrate_pb
- concentrate_sol
- concentrate_au
- recovery
- Rougher tails — отвальные хвосты
    - tail_ag
    - tail_pb
    - tail_sol
    - tail_au
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
    - Xanthate — ксантогенат (промотер, или активатор флотации);
    - Sulphate — сульфат (на данном производстве сульфид натрия);
    - Depressant — депрессант (силикат натрия).
- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed_size — размер гранул сырья
- feed_rate — скорость подачи
- Float banks — флотационная установка. Например:
    - floatbank8_a_air
    - floatbank8_a_level
    - floatbank10_d_air
    - floatbank10_d_level
    - floatbank11_sulfate_to_au_feed
    - floatbank11_sulfate
    - floatbank11_xanthate


## Задача

- Подготовить данные;
    - В том числе проверить, что эффективность обогащения рассчитана правильно.
    - Вычислить эффективность обогащения на обучающей выборке для признака rougher.output.recovery. Найти МАЕ между нашими расчётами и значением признака в данных.
    - Проанализировать признаки, недоступные в тестовой выборке.

- Провести исследовательский анализ данных;
    - Посмотреть как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки.
    - Сравнить распределение размеров гранул сырья на обучающей и тестовой выборках. Если распределения сильно отличаются друг от друга, оценка модели может быть неправильной.
    - Исследовать суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах

- Построить и обучить модель.
    - Написать функцию для вычисления итоговой метрики sMAPE
    - Обучить разные модели и оценить их качество кросс-валидацией

## Используемые библиотеки.
- `pandas`
- `numpy`
- `matplotlib`
- `seaborn`
- `sklearn`: `LinearRegression`, `DecisionTreeRegressor`, `RandomForestRegressor`

